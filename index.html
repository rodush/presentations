<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>HtmlUnit: Cornersides, Hints and Tricks</title>

        <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
        <meta name="author" content="Hakim El Hattab">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/beige.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <section>
                    <h1>HtmlUnit</h1>
                    <h3>Cornersides, hints and tricks</h3>
                    <p>
                        <small>Created by <a href="http://rodush.com">Roman Dushko</a> / <a href="mailto:rdushko@cogniance.com">rdushko</a></small>
                    </p>
                </section>

                <section>
                    <blockquote>
                        HtmlUnit is a "GUI-Less browser for Java programs".
                        It models HTML documents and provides an API that allows you to invoke pages, fill out forms,
                        click links, etc... just like you do in your "normal" browser.
                    </blockquote>
                </section>

                <section>
                    <h2>Why?</h2>
                    <ul>
                        <li>Functional testing - QAs</li>
                        <li>Screen Scraping - DEVs</li>
                    </ul>
                </section>

                <section>
                    <h3>Competitors?</h3>
                    <p>SeleniumRC</p>
                    <hr/>
                    <h3>Difference?</h3>
                    <ul>
                        <li>No need to have a real web-browser installed</li>
                        <li>Able to run w/o graphics interface</li>
                    </ul>
                </section>

                <section>
                    <h2>What do I need to know?</h2>
                    <ul>
                        <li>Be comfortable with Java syntax</li>
                        <li>Able to compile Java classes</li>
                        <li>Understand HTML and a little bit - JS</li>
                        <li><a href="http://htmlunit.sourceforge.net/">HtmlUnit</a> library itself</li>
                    </ul>
                </section>

                <section>
                    <h2>How does it look like to the server?</h2>
                    <br/>
                    <h3>Simulated Web Browsers:</h3>
                    <ul>
                        <li><b>CHROME_16</b> - <em style="color: red;">Warning: highly experimental!!!</em></li>
                        <li><b>FIREFOX_10</b> - <em style="color: red;">Warning: experimental!!!</em></li>
                        <li><b>FIREFOX_3_6</b> - Very stable and thoroughly tested</li>
                        <li><b>INTERNET_EXPLORER_6-8</b> - Stable</li>
                    </ul>
                </section>

                <section>
                    <h2>Supported features:</h2>
                    <ul>
                        <li>XPath (v1.0)</li>
                        <li>Canvas</li>
                        <li>SVG</li>
                        <li>JavaScript + most of modern frameworks<br/>(jQuery, AngularJS)</li>
                        <li>HTML5 + CSS3</li>
                        <li><span style="text-decoration: line-through;">Flash</span></li>

                    </ul>
                </section>

                <section>
                    <h2>Most often used</h2>
                    <ul>
                        <li>
                            <p>Interaction with DOM Elements</p>
                            <ul>
                                <li>Click links</li>
                                <li>Fill-in and submit forms</li>
                            </ul>
                        </li>
                        <li>Check for presence of DOM Elements on the page</li>
                    </ul>
                </section>

                <!-- TODO: Continue... -->

                <section>
                    <h3>Input: type() VS setValueAttribute()</h3>
                    <a href="http://localhost:8000/" target="_blank">Go to example page</a>
                    <pre><code contenteditable style="font-size: 20px; margin-top: 20px;">
HtmlPage page2 = (HtmlPage) client.getPage("http://localhost:8000");
HtmlForm aForm = (HtmlForm) page2.getFormByName("testForm");
HtmlInput loginInput = (HtmlInput) aForm.getInputByName("login");
loginInput.setValueAttribute("someText");
System.out.println( "Here how page looks like after {setValue}: " + page2.asXml() );
loginInput.type("Now we type and check...");
System.out.println( "Here how page looks like after {type}: " + page2.asXml() );
                    </code></pre>
                </section>

                <section>
                    <h3>WebWindows VS TopLevelWindows</h3>
                    <a href="http://localhost:8000/examples/page_with_iframes.html" target="_blank">Go to example page</a>
                    <pre><code contenteditable style="font-size: 25px; line-height: 30px; margin-top: 20px;">
HtmlPage page = client.getPage( "http://localhost:8000/examples/page_with_iframes.html" );

int openedTopWindowsCnt = client.getTopLevelWindows().size();
int webWindowsCnt = client.getWebWindows().size();

System.out.println( "We have " + openedTopWindowsCnt + " Top Level windows, and " +
webWindowsCnt + " web windows currently opened" );
                    </code></pre>
                    <h5 style="text-transform: none;"><sup>*</sup>TopLevelWindow - is basically a window inside
                        a real web-browser (a Tab)</h5>
                </section>
                <section>
                    <h3>Default and Custom Alert and Confirm Handlers</h3>
                    <h5>Default behavior:</h5>
                    <ul>
                        <li>Click "OK" in Alert box</li>
                        <li>Click "Yes" in Confirm dialog</li>
                    </ul>
                    <hr/>
                    <p>If you want log message or click "No" in confirm dialog, then you need overwrite handlers</p>
                </section>
                <section>
                    <h3>Attachment handler</h3>
                    <pre><code>
// Attach attachment handler
client.setAttachmentHandler( new CollectingAttachmentHandler() );
...............do your interaction................
// now just process everything been collected
// Here starts downloading of the file...
List&lt;Attachment&gt; attachments = ((CollectingAttachmentHandler) client.getAttachmentHandler()).getCollectedAttachments();
// Save file on the disc
File torrentFile = new File( attachments.get(0).getSuggestedFilename() );
if( !torrentFile.exists() ){
    torrentFile.createNewFile();
}
</code></pre>
...
                    And no any extra (useless) stuff in your browsing history!
                </section>

                <section>
                    <h3>File uploading</h3>
                    <pre><code>
HtmlForm uploadForm = page.getFormByName("uploadform");
HtmlFileInput fileInput = uploadForm.getInputByName("Upload File");
fileInput.setValueAttribute(filePath); // absolute path to a file on disk
fileInput.setContentType("application/pdf");
uploadForm.getButtonByName(name).click();
                    </code></pre>
                </section>

                <section>
                    <h3>Page.asText() vs Page.asXml()</h3>
                    <p><strong>asText()</strong> -  this is how page looks tp the end user</p>
                    <p><strong>asXml()</strong> - this is how page looks after JS were processed and DOM was manipulated</p>
                </section>

                <section>
                    <h3>Response content as string</h3>
                    <p>This what you see in response - no DOM manipulation happens.</p>
                    <p>Useful if you get non Html page, but CSV, TXT or any other type</p>
                </section>

                <section>
                    <h3>wait VS wait starting before</h3>
                    <pre><code>
client.waitForBackgroundJavaScript() - dumb
client.waitForBackgroundJavaScriptStartingBefore() - sophisticated
                    </code></pre>
                </section>

                <section>
                    <h3>Some more hints...</h3>
                    <p>Instead of using such huge construction</p>
                    <pre><code>
List&lt;HtmlHref&gt; aColl = page.getByXPath( "//a[contains(text(), 'Log out')]" );
HtmlHref a = aColl.get(0);
                    </code></pre>
                    <p>if you only need first element, use this:</p>
                    <pre><code>
HtmlHref a = page.getFirstByXPath( "//a[contains(text(, 'Log out'))]" );
                    </code></pre>
                </section>

                <section>
...and much much more on <a href="http://htmlunit.sourceforge.net/apidocs/index.html" target="_blank">official API page</a>
                </section>

                <!--<section id="transitions">-->
                    <!--<h2>Transition Styles</h2>-->
                    <!--<p>-->
                        <!--You can select from different transitions, like: <br>-->
                        <!--<a href="?transition=cube#/transitions">Cube</a> --->
                        <!--<a href="?transition=page#/transitions">Page</a> --->
                        <!--<a href="?transition=concave#/transitions">Concave</a> --->
                        <!--<a href="?transition=zoom#/transitions">Zoom</a> --->
                        <!--<a href="?transition=linear#/transitions">Linear</a> --->
                        <!--<a href="?transition=fade#/transitions">Fade</a> --->
                        <!--<a href="?transition=none#/transitions">None</a> --->
                        <!--<a href="?#/transitions">Default</a>-->
                    <!--</p>-->
                <!--</section>-->

                <!--<section id="themes">-->
                    <!--<h2>Themes</h2>-->
                    <!--<p>-->
                        <!--Reveal.js comes with a few themes built in: <br>-->
                        <!--<a href="?theme=sky#/themes">Sky</a> --->
                        <!--<a href="?theme=beige#/themes">Beige</a> --->
                        <!--<a href="?theme=simple#/themes">Simple</a> --->
                        <!--<a href="?theme=serif#/themes">Serif</a> --->
                        <!--<a href="?theme=night#/themes">Night</a> --->
                        <!--<a href="?#/themes">Default</a>-->
                    <!--</p>-->
                    <!--<p>-->
                        <!--<small>-->
                            <!--* Theme demos are loaded after the presentation which leads to flicker. In production you should load your theme in the <code>&lt;head&gt;</code> using a <code>&lt;link&gt;</code>.-->
                        <!--</small>-->
                    <!--</p>-->
                <!--</section>-->

                <section>
                    <h1>FIN<em>!!!</em></h1>
                    <h3>BY Roman Dushko / rodush.com</h3>
                </section>

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'page', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
